# -*- coding: utf-8 -*-
"""Training_and_Evaluation.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Gw6ro4km-gVHeE0ds2i5N9Es-a5JNA2x
"""

from sklearn.model_selection import RandomizedSearchCV
from src.models import get_models, get_param_grids
from src.evaluation import evaluate_model

def train_and_tune(X_train, y_train, X_test, y_test):
    models = get_models()
    param_grids = get_param_grids()

    results = {}
    trained_models = {}

    for name, model in models.items():
        print(f"Tuning {name}...")

        random_search = RandomizedSearchCV(
            xgb,
            param_distributions=params,
            n_iter=10,
            scoring='r2',
            n_jobs=4,
            cv=None
        )

        grid.fit(X_train, y_train)
        best_model = grid.best_estimator_

        metrics = evaluate_model(best_model, X_test, y_test)

        trained_models[name] = best_model
        results[name] = {
            "Best Params": grid.best_params_,
            **metrics
        }

    return trained_model, results

def best_params(trained_model):
    print('\n Best hyperparameters')
    print(trained_model.best_params_)
    print('\n Best score')
    print(trained_model.best_score_)